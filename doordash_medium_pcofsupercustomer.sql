-- Create the deliveries table
/*CREATE TABLE order_data_dd (
    restaurant_id INT,
    delivery_id INT PRIMARY KEY,
    customer_id INT,
    order_timestamp DATETIME
);

-- Insert sample data
INSERT INTO order_data_dd (restaurant_id, delivery_id, customer_id, order_timestamp) 
VALUES
(101, 1, 201, '2023-01-02 12:30:00'),
(102, 2, 202, '2023-01-02 14:15:00'),
(103, 3, 203, '2023-01-03 18:45:00'),
(104, 4, 204, '2023-01-04 11:20:00'),
(105, 5, 201, '2023-01-05 19:00:00'),
(106, 6, 205, '2023-01-05 21:10:00'),
(107, 7, 206, '2023-01-06 13:50:00'),
(108, 8, 207, '2023-01-07 15:40:00'),
(109, 9, 201, '2023-01-08 17:25:00'),
(110, 10, 208, '2023-01-09 20:05:00'),
(111, 11, 202, '2023-01-10 22:15:00'),
(112, 12, 209, '2023-01-11 09:30:00'),
(113, 13, 210, '2023-01-12 10:45:00'),
(114, 14, 211, '2023-01-13 12:00:00'),
(115, 15, 201, '2023-01-14 13:10:00'),
(116, 16, 203, '2023-01-15 14:20:00'),
(117, 17, 202, '2023-01-16 15:35:00'),
(118, 18, 204, '2023-01-17 16:50:00'),
(119, 19, 205, '2023-01-18 18:05:00'),
(120, 20, 206, '2023-01-19 19:20:00'),
(121, 21, 201, '2023-01-20 20:35:00'),
(122, 22, 207, '2023-01-21 21:50:00'),
(123, 23, 208, '2023-01-22 23:05:00'),
(124, 24, 209, '2023-01-23 08:20:00'),
(125, 25, 210, '2023-01-24 09:35:00'),
(126, 26, 211, '2023-01-25 10:50:00'),
(127, 27, 201, '2023-01-26 12:05:00'),
(128, 28, 203, '2023-01-27 13:20:00'),
(129, 29, 202, '2023-01-28 14:35:00'),
(130, 30, 204, '2023-01-29 15:50:00');
*/

Select * from order_data_dd

WITH super_customer AS (
    SELECT 
        customer_id, 
        COUNT(delivery_id) AS no_of_orders
    FROM order_data_dd
    GROUP BY customer_id
)
SELECT 
    CAST(COUNT(CASE WHEN no_of_orders > 5 THEN 1 END) * 100.0 / COUNT(*) AS DECIMAL(5,2)) AS super_customer_pc
FROM super_customer;